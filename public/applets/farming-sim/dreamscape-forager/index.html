<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dreamscape Forager</title>
    <style>
        :root {
            --bg-warm: #ff7e5f;
            --bg-cool: #feb47b;
            --accent-blue: #00f260;
            --accent-cyan: #0575e6;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #1a1a1a;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
            -webkit-user-select: none;
        }

        #background-image-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.png');
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            z-index: -1; /* Place it behind the main background */
        }

        /* The Dreamy Background Layer */
        #background-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, #ff512f, #dd2476, #4ca1af, #c4e0e5);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: 0;
        }

        /* Bokeh Effects */
        .bokeh {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            filter: blur(20px);
            animation: float 10s infinite ease-in-out;
            z-index: 1;
        }

        /* Game Container */
        #game-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            overflow: hidden;
        }

        /* UI Overlay */
        #ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            pointer-events: none;
        }

        h1 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 2px;
        }

        #score-display {
            font-size: 2.5rem;
            font-weight: 700;
        }

        #instructions {
            position: absolute;
            bottom: 40px;
            width: 100%;
            text-align: center;
            color: rgba(255,255,255,0.8);
            font-size: 1.2rem;
            animation: pulse 2s infinite;
            pointer-events: none;
            z-index: 100;
        }

        /* The Bird */
        #bird {
            position: absolute;
            width: 40px;
            height: 40px;
            z-index: 20;
            transform-origin: center;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.4));
        }

        /* Platforms (Mossy Clusters) */
        .platform {
            position: absolute;
            background: radial-gradient(circle at 30% 30%, #81c784, #2e7d32);
            border-radius: 50% 50% 40% 40%;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
            z-index: 15;
        }

        /* Flowers on platforms */
        .flower {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px white;
        }

        /* Branches (SVG Lines) */
        .branch {
            position: absolute;
            stroke: #3e2723;
            stroke-width: 4;
            fill: none;
            stroke-linecap: round;
            z-index: 14;
            filter: blur(0.5px);
        }

        /* Collectibles (Dewdrops) */
        .dewdrop {
            position: absolute;
            width: 15px;
            height: 15px;
            background: radial-gradient(circle at 30% 30%, #fff, #a7ffeb);
            border-radius: 50%;
            box-shadow: 0 0 10px #a7ffeb, 0 0 20px #a7ffeb;
            z-index: 16;
            animation: glow 1.5s infinite alternate;
        }

        /* Foreground Blur */
        #foreground-blur {
            position: absolute;
            bottom: -50px;
            left: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            backdrop-filter: blur(4px);
            z-index: 30;
            pointer-events: none;
        }

        /* Animations */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); opacity: 0.5; }
            50% { transform: translateY(-20px) scale(1.2); opacity: 0.8; }
        }

        @keyframes pulse {
            0% { opacity: 0.5; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px #fff, 0 0 10px #00e5ff; }
            to { box-shadow: 0 0 10px #fff, 0 0 20px #00e5ff; }
        }

        /* SVG Bird Styling */
        .bird-svg {
            fill: #1a1a1a;
        }
        .bird-eye {
            fill: #fff;
        }
        .bird-leg {
            stroke: #1a1a1a;
            stroke-width: 2;
        }

    </style>
</head>
<body>

    <div id="background-image-layer"></div>
    <!-- Background Ambience -->
    <div id="background-layer">
        <!-- Procedural Bokeh generated by JS -->
    </div>

    <!-- Game World -->
    <div id="game-container">
        <div id="bird">
            <!-- SVG Silhouette Bird -->
            <svg viewBox="0 0 100 100" class="bird-svg-container">
                <!-- Legs -->
                <path d="M45,70 L45,90 L40,95 M55,70 L55,85 L60,90" class="bird-leg" fill="none" />
                <!-- Body -->
                <path d="M30,60 Q20,50 30,40 Q40,20 60,25 Q75,28 80,35 L85,37 L80,40 Q75,50 70,60 Q60,75 40,70 Z" class="bird-svg" />
                <!-- Eye -->
                <circle cx="65" cy="32" r="2" class="bird-eye" />
            </svg>
        </div>
    </div>

    <!-- Foreground Aesthetics -->
    <div id="foreground-blur"></div>

    <!-- UI -->
    <div id="ui-layer">
        <h1>DREAMSCAPE FORAGER</h1>
        <div id="score-display">0</div>
    </div>

    <div id="instructions">Click or Spacebar to Hop</div>

    <script>
        /**
         * DREAMSCAPE FORAGER
         * A zen endless runner based on the provided image.
         * Focus: Atmosphere, Physics, Lighting.
         */

        const container = document.getElementById('game-container');
        const birdEl = document.getElementById('bird');
        const scoreEl = document.getElementById('score-display');
        const bgLayer = document.getElementById('background-layer');
        const instructions = document.getElementById('instructions');

        // Game State
        let gameRunning = false;
        let score = 0;
        let speed = 3; // World scroll speed
        let gravity = 0.5;
        let velocityY = 0;
        let birdY = window.innerHeight / 2;
        let birdX = window.innerWidth * 0.2;
        let platforms = [];
        let dewdrops = [];
        let branches = [];
        let particles = [];
        let frameId;

        // Setup Audio Context (Synthesized Sounds)
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            const now = audioCtx.currentTime;
            
            if (type === 'jump') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.exponentialRampToValueAtTime(600, now + 0.1);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
                osc.start(now);
                osc.stop(now + 0.2);
            } else if (type === 'collect') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(800, now);
                osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                gain.gain.setValueAtTime(0.2, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                osc.start(now);
                osc.stop(now + 0.3);
            }
        }

        // Initialization
        function init() {
            // Generate Bokeh Background
            for (let i = 0; i < 15; i++) {
                createBokeh();
            }
            
            // Initial Platform
            createPlatform(birdX - 50, birdY + 40, 200);
            
            // Fill screen with platforms
            let nextX = birdX + 200;
            while (nextX < window.innerWidth + 200) {
                createPlatform(nextX, Math.random() * (window.innerHeight - 200) + 100, Math.random() * 100 + 100);
                nextX += Math.random() * 150 + 100;
            }

            gameLoop();
        }

        function createBokeh() {
            const div = document.createElement('div');
            div.classList.add('bokeh');
            const size = Math.random() * 100 + 50;
            div.style.width = `${size}px`;
            div.style.height = `${size}px`;
            div.style.left = `${Math.random() * 100}%`;
            div.style.top = `${Math.random() * 100}%`;
            div.style.background = Math.random() > 0.5 ? 'rgba(255, 100, 100, 0.2)' : 'rgba(100, 200, 255, 0.2)';
            div.style.animationDuration = `${Math.random() * 10 + 5}s`;
            bgLayer.appendChild(div);
        }

        function createPlatform(x, y, width) {
            const el = document.createElement('div');
            el.classList.add('platform');
            el.style.width = `${width}px`;
            el.style.height = `60px`;
            el.style.left = `${x}px`;
            el.style.top = `${y}px`;
            
            // Add random flowers
            if (Math.random() > 0.5) {
                const flower = document.createElement('div');
                flower.classList.add('flower');
                flower.style.left = `${Math.random() * (width - 20) + 10}px`;
                flower.style.top = `-5px`;
                flower.style.background = Math.random() > 0.5 ? '#fff' : '#ffeb3b';
                el.appendChild(flower);
            }

            container.appendChild(el);
            platforms.push({ el, x, y, width, height: 60 });

            // Chance to spawn dewdrop above
            if (Math.random() > 0.3) {
                createDewdrop(x + width/2, y - 100 - Math.random() * 100);
            }

            // Chance to spawn branch decoration
            if (Math.random() > 0.6) {
                createBranch(x, y);
            }
        }

        function createDewdrop(x, y) {
            const el = document.createElement('div');
            el.classList.add('dewdrop');
            el.style.left = `${x}px`;
            el.style.top = `${y}px`;
            container.appendChild(el);
            dewdrops.push({ el, x, y, width: 15, height: 15, collected: false });
        }

        function createBranch(x, y) {
            // SVG Branch
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute("width", "200");
            svg.setAttribute("height", "200");
            svg.style.position = "absolute";
            svg.style.left = `${x - 50}px`;
            svg.style.top = `${y}px`;
            svg.style.overflow = "visible";
            svg.style.zIndex = "14";
            
            const path = document.createElementNS(svgNS, "path");
            // Random spindly curve
            const d = `M50,0 Q${Math.random()*100},${Math.random()*100} ${Math.random()*100 - 50},150`;
            path.setAttribute("d", d);
            path.setAttribute("stroke", "#3e2723");
            path.setAttribute("stroke-width", "3");
            path.setAttribute("fill", "none");
            
            svg.appendChild(path);
            container.appendChild(svg);
            branches.push({ el: svg, x: x - 50 });
        }

        function jump() {
            velocityY = -10;
            gameRunning = true;
            instructions.style.opacity = 0;
            playSound('jump');
            
            // Tilt bird
            birdEl.style.transform = 'rotate(-20deg)';
        }

        function gameOver() {
            // Zen mode: Don't end game, just reset bird position gently
            velocityY = -15; // Super jump back up
            score = Math.max(0, score - 5); // Small penalty
            scoreEl.innerText = score;
            
            // Visual feedback
            const flash = document.createElement('div');
            flash.style.position = 'absolute';
            flash.style.top = '0'; flash.style.left = '0';
            flash.style.width = '100%'; flash.style.height = '100%';
            flash.style.background = 'white';
            flash.style.opacity = '0.5';
            flash.style.zIndex = '200';
            document.body.appendChild(flash);
            setTimeout(() => flash.remove(), 100);
        }

        function gameLoop() {
            if (gameRunning) {
                // Physics
                velocityY += gravity;
                birdY += velocityY;

                // Terminal velocity
                if (velocityY > 10) velocityY = 10;

                // Rotation based on velocity
                const rot = Math.min(Math.max(velocityY * 3, -25), 45);
                birdEl.style.transform = `rotate(${rot}deg)`;

                // Move World
                platforms.forEach(p => p.x -= speed);
                dewdrops.forEach(d => d.x -= speed);
                branches.forEach(b => b.x -= speed);

                // Collision Detection (Platforms)
                let onGround = false;
                platforms.forEach(p => {
                    // Simple AABB collision for landing
                    if (
                        birdX + 20 > p.x && 
                        birdX < p.x + p.width &&
                        birdY + 40 >= p.y && 
                        birdY + 40 <= p.y + 20 &&
                        velocityY >= 0
                    ) {
                        birdY = p.y - 40;
                        velocityY = 0;
                        onGround = true;
                        birdEl.style.transform = 'rotate(0deg)';
                    }
                });

                // Collision (Dewdrops)
                dewdrops.forEach(d => {
                    if (!d.collected) {
                        const dx = (birdX + 20) - (d.x + 7.5);
                        const dy = (birdY + 20) - (d.y + 7.5);
                        const dist = Math.sqrt(dx*dx + dy*dy);
                        if (dist < 30) {
                            d.collected = true;
                            d.el.style.transform = 'scale(2)';
                            d.el.style.opacity = '0';
                            score++;
                            scoreEl.innerText = score;
                            playSound('collect');
                            
                            // Speed up slightly
                            if(score % 5 === 0) speed += 0.2;
                        }
                    }
                });

                // Cleanup off-screen
                platforms = platforms.filter(p => {
                    if (p.x + p.width < -100) {
                        p.el.remove();
                        return false;
                    }
                    return true;
                });
                dewdrops = dewdrops.filter(d => {
                    if (d.x < -50 || d.collected && d.el.style.opacity == '0') {
                        if (d.x < -50) d.el.remove(); // remove if offscreen
                        // keep collected ones briefly for anim
                        if(d.collected) setTimeout(() => d.el.remove(), 200); 
                        return !d.collected && d.x > -50;
                    }
                    return true;
                });
                branches = branches.filter(b => {
                    if (b.x < -200) {
                        b.el.remove();
                        return false;
                    }
                    return true;
                });

                // Spawn new elements
                const lastPlatform = platforms[platforms.length - 1];
                if (lastPlatform && lastPlatform.x < window.innerWidth - 100) {
                    const gap = Math.random() * 100 + 50;
                    const w = Math.random() * 150 + 80;
                    // Keep y reachable
                    let y = lastPlatform.y + (Math.random() * 200 - 100);
                    y = Math.max(100, Math.min(window.innerHeight - 100, y));
                    
                    createPlatform(window.innerWidth, y, w);
                }

                // Fall off screen check
                if (birdY > window.innerHeight) {
                    gameOver();
                }
            } else {
                // Idle hover animation
                birdY = (window.innerHeight / 2) + Math.sin(Date.now() / 500) * 10;
            }

            // Apply positions
            birdEl.style.top = `${birdY}px`;
            birdEl.style.left = `${birdX}px`;
            
            platforms.forEach(p => p.el.style.left = `${p.x}px`);
            dewdrops.forEach(d => d.el.style.left = `${d.x}px`);
            branches.forEach(b => b.el.style.left = `${b.x}px`);

            requestAnimationFrame(gameLoop);
        }

        // Input Handling
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') jump();
        });
        window.addEventListener('mousedown', jump);
        window.addEventListener('touchstart', (e) => {
            e.preventDefault(); // prevent scroll
            jump();
        }, {passive: false});

        init();

    </script>
</body>
</html>