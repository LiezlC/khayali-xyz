<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromatic Dialogue | Interactive Art</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;600&display=swap');

        body {
            margin: 0;
            overflow: hidden;
            background-color: #0f0f11;
            font-family: 'Inter', sans-serif;
            touch-action: none;
        }

        #app-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        /* The Silhouette Overlay */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none; /* Let clicks pass through to canvas */
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .silhouette {
            width: 40%;
            height: 100%;
            fill: #050505;
            filter: drop-shadow(0 0 20px rgba(0,0,0,0.8));
        }

        /* UI Controls */
        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            background: rgba(20, 20, 25, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 16px 24px;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 16px;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }

        .controls:hover {
            background: rgba(20, 20, 25, 0.8);
            border-color: rgba(255, 255, 255, 0.2);
        }

        button {
            background: transparent;
            border: none;
            color: #fff;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: transform 0.2s, background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            background: rgba(255,255,255,0.1);
            transform: scale(1.1);
        }

        button.active {
            background: rgba(255,255,255,0.2);
            color: #4facfe;
        }

        .palette-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .palette-dot:hover { transform: scale(1.2); }
        .palette-dot.selected { border-color: #fff; transform: scale(1.1); }

        .tooltip {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255,255,255,0.5);
            font-size: 14px;
            pointer-events: none;
            z-index: 15;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0;
            animation: fadeIn 2s forwards 1s;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        /* SVG Icons */
        .icon { width: 24px; height: 24px; stroke: currentColor; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    </style>
</head>
<body>

<div id="app-container">
    <div class="tooltip">Paint the silence between them</div>
    
    <canvas id="artCanvas"></canvas>

    <!-- Silhouette Overlay -->
    <div class="overlay">
        <!-- Left Profile -->
        <svg class="silhouette" viewBox="0 0 100 200" preserveAspectRatio="none">
            <path d="M0,200 L0,0 L20,0 C20,0 50,30 40,50 C35,60 55,65 55,75 C55,80 45,85 45,90 C45,95 50,100 40,110 C30,120 40,140 20,160 C10,170 60,200 60,200 Z" />
        </svg>
        <!-- Right Profile (Mirrored) -->
        <svg class="silhouette" viewBox="0 0 100 200" preserveAspectRatio="none">
            <path d="M100,200 L100,0 L80,0 C80,0 50,30 60,50 C65,60 45,65 45,75 C45,80 55,85 55,90 C55,95 50,100 60,110 C70,120 60,140 80,160 C90,170 40,200 40,200 Z" />
        </svg>
    </div>

    <!-- Controls -->
    <div class="controls">
        <div class="flex gap-2 border-r border-white/10 pr-4">
            <div class="palette-dot selected" style="background: linear-gradient(135deg, #ff00cc, #333399);" onclick="setPalette('neon')" title="Neon Nights"></div>
            <div class="palette-dot" style="background: linear-gradient(135deg, #f12711, #f5af19);" onclick="setPalette('fire')" title="Passion Fire"></div>
            <div class="palette-dot" style="background: linear-gradient(135deg, #00c6ff, #0072ff);" onclick="setPalette('ocean')" title="Deep Ocean"></div>
            <div class="palette-dot" style="background: linear-gradient(135deg, #11998e, #38ef7d);" onclick="setPalette('nature')" title="Toxic Nature"></div>
        </div>

        <button id="btn-auto" onclick="toggleAutoMode()" title="Auto Dialogue">
            <svg class="icon"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
        </button>
        
        <button onclick="clearCanvas()" title="Clear Canvas">
            <svg class="icon"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
        </button>

        <button onclick="downloadArt()" title="Save Snapshot">
            <svg class="icon"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
        </button>
    </div>
</div>

<script>
    const canvas = document.getElementById('artCanvas');
    const ctx = canvas.getContext('2d');
    
    // State
    let width, height;
    let particles = [];
    let autoMode = false;
    let autoInterval;
    let mouse = { x: 0, y: 0, down: false };
    
    // Palettes
    const palettes = {
        neon: ['#FF00CC', '#333399', '#00FFFF', '#FF3366', '#9900FF'],
        fire: ['#F12711', '#F5AF19', '#FF4500', '#FFD700', '#8B0000'],
        ocean: ['#00C6FF', '#0072FF', '#000080', '#1E90FF', '#E0FFFF'],
        nature: ['#11998E', '#38EF7D', '#ADFF2F', '#006400', '#32CD32']
    };
    let currentPalette = palettes.neon;

    // Resize Handling
    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
        // Fill background initially
        ctx.fillStyle = '#0f0f11';
        ctx.fillRect(0, 0, width, height);
    }
    window.addEventListener('resize', resize);
    resize();

    // Particle Class (The "Drips")
    class Drip {
        constructor(x, y, color) {
            this.x = x;
            this.y = y;
            this.color = color;
            this.size = Math.random() * 15 + 5;
            this.speedY = Math.random() * 5 + 2;
            this.life = 1.0;
            this.decay = Math.random() * 0.005 + 0.002;
            this.wobble = Math.random() * Math.PI * 2;
        }

        update() {
            this.y += this.speedY;
            this.life -= this.decay;
            this.size -= 0.05;
            this.wobble += 0.1;
            this.x += Math.sin(this.wobble) * 0.5; // Slight horizontal drip wobble
            
            // Leave a trail
            if (this.life > 0 && this.size > 0) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.fill();
                ctx.globalAlpha = 1.0;
            }
        }
    }

    class Splatter {
        constructor(x, y, color) {
            this.x = x;
            this.y = y;
            this.color = color;
            this.radius = 0;
            this.maxRadius = Math.random() * 50 + 30;
            this.speed = Math.random() * 2 + 1;
            this.opacity = 1;
        }

        update() {
            this.radius += this.speed;
            this.opacity -= 0.02;
            
            if (this.opacity > 0) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 2;
                ctx.globalAlpha = this.opacity;
                ctx.stroke();
                ctx.globalAlpha = 1.0;
            }
        }
    }

    // Animation Loop
    function animate() {
        // We don't clearRect here to allow paint to pile up, 
        // but we slightly darken the background for a trail effect?
        // No, let's keep it persistent like a painting.
        
        // Update Particles
        for (let i = particles.length - 1; i >= 0; i--) {
            let p = particles[i];
            p.update();
            if (p.life <= 0 || p.size <= 0 || p.opacity <= 0 || p.y > height) {
                particles.splice(i, 1);
            }
        }

        requestAnimationFrame(animate);
    }
    animate();

    // Input Handling
    function addDrip(x, y) {
        const color = currentPalette[Math.floor(Math.random() * currentPalette.length)];
        particles.push(new Drip(x, y, color));
        
        // Occasionally add a splatter ring
        if (Math.random() > 0.9) {
            particles.push(new Splatter(x, y, color));
        }
    }

    window.addEventListener('mousemove', (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
        
        // Add drips if moving fast or randomly
        if (Math.random() > 0.5) {
            addDrip(mouse.x, mouse.y);
        }
    });

    window.addEventListener('touchmove', (e) => {
        const touch = e.touches[0];
        addDrip(touch.clientX, touch.clientY);
    });

    window.addEventListener('click', (e) => {
        // Burst of drips
        for(let i=0; i<10; i++) {
            addDrip(e.clientX + (Math.random()-0.5)*40, e.clientY + (Math.random()-0.5)*40);
        }
        // Big splatter
        const color = currentPalette[Math.floor(Math.random() * currentPalette.length)];
        particles.push(new Splatter(e.clientX, e.clientY, color));
    });

    // UI Functions
    function setPalette(name) {
        currentPalette = palettes[name];
        document.querySelectorAll('.palette-dot').forEach(dot => dot.classList.remove('selected'));
        event.target.classList.add('selected');
    }

    function clearCanvas() {
        ctx.fillStyle = '#0f0f11';
        ctx.fillRect(0, 0, width, height);
        particles = [];
    }

    function toggleAutoMode() {
        autoMode = !autoMode;
        const btn = document.getElementById('btn-auto');
        btn.classList.toggle('active');
        
        if (autoMode) {
            autoInterval = setInterval(() => {
                // Simulate conversation flow
                // Random x between 20% and 80% of screen (between faces)
                const x = Math.random() * (width * 0.6) + (width * 0.2);
                const y = Math.random() * (height * 0.5);
                
                // Burst
                for(let i=0; i<5; i++) {
                    addDrip(x + (Math.random()-0.5)*20, y);
                }
            }, 100);
        } else {
            clearInterval(autoInterval);
        }
    }

    function downloadArt() {
        const link = document.createElement('a');
        link.download = 'chromatic-dialogue.png';
        link.href = canvas.toDataURL();
        link.click();
    }

    // Initial Splash
    setTimeout(() => {
        for(let i=0; i<20; i++) {
            addDrip(width/2 + (Math.random()-0.5)*100, height/3);
        }
    }, 500);

</script>
</body>
</html>