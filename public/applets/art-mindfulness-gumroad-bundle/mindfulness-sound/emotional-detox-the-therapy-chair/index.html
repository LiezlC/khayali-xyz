<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotional Detox: The Therapy Chair</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');

        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at center bottom, #e0e0e0, #a0a0a0);
            height: 100vh;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            user-select: none;
        }

        /* UI Overlay */
        .ui-layer {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 50;
            pointer-events: none;
        }

        .hud {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
            pointer-events: auto;
            transition: all 0.3s ease;
        }

        .progress-bar {
            width: 200px;
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #3b82f6);
            width: 0%;
            transition: width 0.5s ease-out;
        }

        /* The Chair - CSS Art */
        .chair-container {
            position: absolute;
            bottom: 10%;
            left: 15%;
            width: 280px;
            height: 260px;
            perspective: 800px;
            z-index: 10;
            transform: scale(1.2);
        }

        .chair-frame-outer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 160px;
            border: 12px solid #d1d5db; /* Silver frame */
            border-top: none;
            background: transparent;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1), 2px 2px 10px rgba(0,0,0,0.2);
            z-index: 5;
            border-radius: 0 0 4px 4px;
            background: linear-gradient(to right, #e5e7eb 0%, #9ca3af 20%, #e5e7eb 50%, #9ca3af 80%, #e5e7eb 100%);
            -webkit-background-clip: border-box;
        }
        
        /* Chrome effect helper */
        .chrome {
            background: linear-gradient(135deg, #f3f4f6 0%, #9ca3af 50%, #f3f4f6 100%);
        }

        .cushion-base {
            position: absolute;
            bottom: 20px;
            left: 15px;
            width: calc(100% - 30px);
            height: 100px;
            background: #fff;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 4;
        }
        
        .cushion-seat {
            position: absolute;
            bottom: 120px;
            left: 15px;
            width: calc(100% - 30px);
            height: 20px;
            background: #f9fafb;
            z-index: 4;
            border-bottom: 1px solid #eee;
        }

        .cushion-back {
            position: absolute;
            bottom: 120px;
            left: 15px;
            width: calc(100% - 30px);
            height: 140px;
            background: #fff;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            z-index: 3;
        }
        
        .cushion-side-l, .cushion-side-r {
            position: absolute;
            bottom: 20px;
            width: 20px;
            height: 140px;
            background: #fff;
            z-index: 4;
            border: 1px solid #f3f4f6;
        }
        .cushion-side-l { left: 20px; }
        .cushion-side-r { right: 20px; }

        /* The Ghosts - CSS Art */
        .ghost-zone {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicking through empty space */
        }

        .ghost {
            position: absolute;
            width: 180px;
            height: 220px;
            pointer-events: auto;
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.5s ease;
            animation: floaty 6s infinite ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @keyframes floaty {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }

        .smoke-layer {
            position: absolute;
            border-radius: 50%;
            filter: blur(20px);
            opacity: 0.6;
            animation: smoke-pulse 4s infinite alternate;
        }

        @keyframes smoke-pulse {
            0% { transform: scale(1); opacity: 0.5; }
            100% { transform: scale(1.1); opacity: 0.7; }
        }

        /* Ghost Colors */
        .ghost-blue .smoke-layer { background: radial-gradient(circle, #60a5fa, #3b82f6, transparent); }
        .ghost-pink .smoke-layer { background: radial-gradient(circle, #f472b6, #ec4899, transparent); }
        .ghost-green .smoke-layer { background: radial-gradient(circle, #4ade80, #22c55e, transparent); }

        /* Face */
        .face {
            position: relative;
            z-index: 10;
            width: 100px;
            height: 100px;
            opacity: 0.8;
        }

        .eye {
            position: absolute;
            top: 30px;
            width: 12px;
            height: 18px;
            background: #1f2937; /* Dark grey */
            border-radius: 50%;
            transform: rotate(10deg);
        }
        .eye.left { left: 25px; transform: rotate(-10deg); }
        .eye.right { right: 25px; transform: rotate(10deg); }

        /* Eyebrows for sadness */
        .eyebrow {
            position: absolute;
            top: 15px;
            width: 20px;
            height: 4px;
            background: #1f2937;
            border-radius: 2px;
        }
        .eyebrow.left { left: 20px; transform: rotate(-20deg); }
        .eyebrow.right { right: 20px; transform: rotate(20deg); }

        .mouth {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 20px;
            border-top: 4px solid #1f2937;
            border-radius: 50% 50% 0 0; /* Frown */
            transition: all 0.3s ease;
        }

        /* Happy State */
        .ghost.soothed .mouth {
            border-top: none;
            border-bottom: 4px solid #fff;
            border-radius: 0 0 50% 50%; /* Smile */
            bottom: 25px;
        }
        .ghost.soothed .eyebrow {
            display: none;
        }
        .ghost.soothed .eye {
            height: 12px; /* squint */
            background: #fff;
        }
        .ghost.soothed .smoke-layer {
            filter: blur(30px);
            opacity: 0;
            transition: all 1s ease;
        }
        .ghost.soothed {
            pointer-events: none;
            animation: dissipate 1s forwards;
        }

        @keyframes dissipate {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        /* Particles */
        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            animation: pop 0.8s ease-out forwards;
        }

        @keyframes pop {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }

        /* Message bubble */
        .message-bubble {
            position: absolute;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            color: #333;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s ease;
            pointer-events: none;
            white-space: nowrap;
        }
        .message-bubble.show {
            opacity: 1;
            transform: translateY(0);
        }
        .message-bubble::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid white;
        }

    </style>
</head>
<body>

    <!-- UI Layer -->
    <div class="ui-layer">
        <div class="hud">
            <h1 class="text-xl font-bold text-gray-700">Emotional Detox</h1>
            <p class="text-xs text-gray-500 mb-2">Click the lingering thoughts to soothe them.</p>
            <div class="flex items-center gap-2 text-sm text-gray-600">
                <span>Clarity:</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="clarity-fill"></div>
                </div>
                <span id="clarity-text">0%</span>
            </div>
        </div>
    </div>

    <!-- The Chair (Visual Anchor) -->
    <div class="chair-container">
        <!-- Back Cushion -->
        <div class="cushion-back"></div>
        <!-- Side Cushions -->
        <div class="cushion-side-l"></div>
        <div class="cushion-side-r"></div>
        <!-- Seat Cushion -->
        <div class="cushion-seat"></div>
        <!-- Base Cushion -->
        <div class="cushion-base"></div>
        <!-- Metal Frame -->
        <div class="chair-frame-outer"></div>
        <!-- Legs -->
        <div class="absolute bottom-[-12px] left-[10px] w-[12px] h-[20px] bg-gray-400"></div>
        <div class="absolute bottom-[-12px] right-[10px] w-[12px] h-[20px] bg-gray-400"></div>
    </div>

    <!-- Ghost Zone -->
    <div class="ghost-zone" id="ghost-zone">
        <!-- Ghosts will be injected here -->
    </div>

    <script>
        const ghostZone = document.getElementById('ghost-zone');
        const clarityFill = document.getElementById('clarity-fill');
        const clarityText = document.getElementById('clarity-text');
        
        let clarity = 0;
        const totalGhosts = 10; // Win condition
        let ghostsSoothed = 0;

        const affirmations = [
            "I acknowledge this feeling.",
            "It's okay to be sad.",
            "This too shall pass.",
            "Breathe in, breathe out.",
            "I am grounded.",
            "Releasing tension...",
            "Finding my center.",
            "Letting go."
        ];

        function createGhost(type, x, y, delay) {
            const ghost = document.createElement('div');
            ghost.className = `ghost ghost-${type}`;
            ghost.style.left = x + '%';
            ghost.style.top = y + '%';
            ghost.style.animationDelay = delay + 's';

            // Smoke layers for volumetric effect
            for(let i=0; i<3; i++) {
                const smoke = document.createElement('div');
                smoke.className = 'smoke-layer';
                smoke.style.width = (100 + Math.random()*60) + 'px';
                smoke.style.height = (100 + Math.random()*60) + 'px';
                smoke.style.top = (Math.random()*40 - 20) + 'px';
                smoke.style.left = (Math.random()*40 - 20) + 'px';
                ghost.appendChild(smoke);
            }

            // Face
            const face = document.createElement('div');
            face.className = 'face';
            face.innerHTML = `
                <div class="eyebrow left"></div>
                <div class="eyebrow right"></div>
                <div class="eye left"></div>
                <div class="eye right"></div>
                <div class="mouth"></div>
            `;
            ghost.appendChild(face);

            // Interaction
            ghost.addEventListener('click', (e) => {
                if(ghost.classList.contains('soothed')) return;
                
                // Soothe logic
                ghost.classList.add('soothed');
                createParticles(e.clientX, e.clientY);
                showAffirmation(e.clientX, e.clientY);
                
                ghostsSoothed++;
                updateProgress();

                // Remove from DOM after animation
                setTimeout(() => {
                    ghost.remove();
                    // Respawn logic if game not over
                    if (ghostsSoothed < totalGhosts) {
                        setTimeout(() => spawnRandomGhost(), 1000); 
                    } else {
                        checkWin();
                    }
                }, 1000);
            });

            ghostZone.appendChild(ghost);
        }

        function createParticles(x, y) {
            for(let i=0; i<12; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                
                const angle = Math.random() * Math.PI * 2;
                const dist = 50 + Math.random() * 50;
                const tx = Math.cos(angle) * dist + 'px';
                const ty = Math.sin(angle) * dist + 'px';
                
                p.style.setProperty('--tx', tx);
                p.style.setProperty('--ty', ty);
                
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 800);
            }
        }

        function showAffirmation(x, y) {
            const msg = document.createElement('div');
            msg.className = 'message-bubble';
            msg.innerText = affirmations[Math.floor(Math.random() * affirmations.length)];
            msg.style.left = (x - 60) + 'px';
            msg.style.top = (y - 120) + 'px';
            document.body.appendChild(msg);

            // Trigger reflow
            void msg.offsetWidth;
            msg.classList.add('show');

            setTimeout(() => {
                msg.classList.remove('show');
                setTimeout(() => msg.remove(), 400);
            }, 1500);
        }

        function updateProgress() {
            const pct = Math.min(100, (ghostsSoothed / totalGhosts) * 100);
            clarityFill.style.width = pct + '%';
            clarityText.innerText = Math.round(pct) + '%';
        }

        function spawnRandomGhost() {
            const types = ['blue', 'pink', 'green'];
            const type = types[Math.floor(Math.random() * types.length)];
            // Random position in the right half/upper area
            const x = 40 + Math.random() * 40; 
            const y = 10 + Math.random() * 40;
            const delay = Math.random() * 2;
            createGhost(type, x, y, delay);
        }

        function checkWin() {
            const hud = document.querySelector('.hud');
            hud.innerHTML = `
                <h1 class="text-2xl font-bold text-green-600">Mind Cleared</h1>
                <p class="text-gray-600 mt-2">You have found your center.</p>
                <button onclick="location.reload()" class="mt-4 px-6 py-2 bg-gray-800 text-white rounded-full hover:bg-gray-700 transition">Start Again</button>
            `;
        }

        // Initial Spawns matching the image roughly
        createGhost('blue', 45, 20, 0);
        createGhost('pink', 60, 25, 1);
        createGhost('green', 75, 20, 2);

    </script>
</body>
</html>